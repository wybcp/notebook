# 函数

## 尽量使用 PHP 内部函数

内置函数使用 C 语言实现，并且经过 PHP 官方优化，效率更高。

## 使用绝对路径

在`include`和`require`中尽量使用绝对路径。

如果包含相对路径，PHP 会在`include_path`里面遍历查找文件。

用绝对路径就会避免此类问题，解析路径所需的时间会更少。

## 包含文件

尽量不要用`require_once`和`include_once`包含文件，它们多一个判断文件是否被引用的过程，能不用尽量不用。

而使用`require`、`include`方法代替。

[鸟哥在其博客中](http://www.laruence.com/2012/09/12/2765.html)就多次声明，尽量不要用`require_once`和`include_once`。

## 使用 isset()和 empty()

与 count()、strlen()和 sizeof()函数相比，isset()和 empty()对于检测一个变量是否为空等场景更加简单和高效。

## 函数快于类方法

调用只有一个参数、并且函数体为空的函数，花费的时间等于`7-8`次`$localvar++`运算。

而同一功能的类方法大约为 15 次`$localvar++`运算。

## 用子类方法

基类里面只放能重用的方法，其他功能尽量放在子类中实现，子类里方法的性能优于在基类中。

## 类的性能和其方法数量没有关系

新添加 10 个或多个方法到测试的类后，性能没什么差异。

## 读取[文件](../function/file.md)内容

在可以用[file_get_contents()](http://php.net/manual/zh/function.file-get-contents.php)替代`file()`、`fopen()`、`feof()`、`fgets()`等系列方法的情况下，尽量用`file_get_contents()`。

## 引用传递参数

通过参数地址引用的方式，实现函数多个返回值，这比按值传递效率高。

方法是在参数变量前加个 `&`。

## 方法不要细分得过多

适当的拆分可以增强重用，可读性变强。

## 尽量静态化

如果一个方法能被静态，那就声明它为静态的，速度可提高`1/4`，甚至我测试的时候，这个提高了近三倍。

当然了，这个测试方法需要在## 十万级## 以上次执行，效果才明显。

其实，静态方法和非静态方法的效率主要区别在## 内存## 。

静态方法在程序开始时生成内存，实例方法（非静态方法）在程序运行中生成内存。

所以，静态方法可以直接调用，实例方法要先成生实例再调用，静态速度很快，但是多了会占内存。

任何语言都是对内存和磁盘的操作，至于是否面向对象，只是软件层的问题，底层都是一样的，只是实现方法不同。

静态内存是连续的，因为是在程序开始时就生成了，而实例方法申请的是离散的空间，所以当然没有静态方法快。

静态方法始终调用同一块内存，其缺点就是不能自动进行销毁，而实例化可以销毁。

## 用 C 扩展方式实现

如果在代码中存在大量耗时的函数，可以考虑用 C 扩展的方式实现它们。
