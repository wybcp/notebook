# MyISAM 存储引擎

不支持事务、也不支持外键，优势是访问速度快，对事务完整性没有要求或者以 select，insert 为主的应用基本上可以用这个引擎来创建表。

支持 3 种不同的存储格式，分别是：静态、动态表、压缩表

静态表：表中的字段都是非变长字段，这样每个记录都是固定长度的，优点存储非常迅速，容易缓存，出现故障容易恢复；缺点是占用的空间通常比动态表多（因为存储时会按照列的宽度定义补足空格）ps：在取数据的时候，默认会把字段后面的空格去掉，如果不注意会把数据本身带的空格也会忽略。

动态表：记录不是固定长度的，这样存储的优点是占用的空间相对较少；缺点：频繁的更新、删除数据容易产生碎片，需要定期执行 OPTIMIZE TABLE 或者 myisamchk-r 命令来改善性能

压缩表：因为每个记录是被单独压缩的，所以只有非常小的访问开支

MyISAM 的表存储成 3 个文件。文件的名字与表名相同。拓展名为*frm*、_MYD_、_MYI_。其实，frm 文件存储表的结构；MYD 文件存储数据，是 MYData 的缩写；MYI 文件存储索引，是 MYIndex 的缩写。

MyISAM：只支持表级锁，只支持表级锁，用户在操作 myisam 表时，select，update，delete，insert 语句都会给表自动加锁。

- 拥有全文索引、压缩、空间函数。
- 不支持事务和行级锁、不支持崩溃后的安全恢复。
- 表存储在两个文件，MYD 和 MYI。
- 设计简单，某些场景下性能很好，例如获取整个表有多少条数据，性能很高。
- 全文索引不是很常用，不如使用外部的 ElasticSearch 或 Lucene。

MyISAM 不支持事务、不支持外键，访问速度快，对事务完整性没有要求或者以 select、insert 为主的用这个引擎创建表。数据文件和索引文件可以分别放在不同的目录，平均分配 IO，获得更快的速度。

## MyISAM

它不支持事务，也不支持外键，尤其是访问速度快，对事务完整性没有要求或者以 SELECT、INSERT 为主的应用基本都可以使用这个引擎来创建表。

每个 MyISAM 在磁盘上存储成 3 个文件，其中文件名和表名都相同，但是扩展名分别为：

- .frm(存储表定义)
- MYD(MYData，存储数据)
- MYI(MYIndex，存储索引)

数据文件和索引文件可以放置在不同的目录，平均分配 IO，获取更快的速度。要指定数据文件和索引文件的路径，需要在创建表的时候通过`DATA DIRECTORY`和`INDEX DIRECTORY`语句指定，文件路径需要使用绝对路径。

每个 MyISAM 表都有一个标志，服务器或 myisamchk 程序在检查 MyISAM 数据表时会对这个标志进行设置。MyISAM 表还有一个标志用来表明该数据表在上次使用后是不是被正常的关闭了。如果服务器以为当机或崩溃，这个标志可以用来判断数据表是否需要检查和修复。如果想让这种检查自动进行，可以在启动服务器时使用--myisam-recover 现象。这会让服务器在每次打开一个 MyISAM 数据表是自动检查数据表的标志并进行必要的修复处理。MyISAM 类型的表可能会损坏，可以使用 CHECK TABLE 语句来检查 MyISAM 表的健康，并用 REPAIR TABLE 语句修复一个损坏到 MyISAM 表。

MyISAM 的表支持 3 种不同的存储格式：

- 静态(固定长度)表
- 动态表
- 压缩表

其中静态表是默认的存储格式。静态表中的字段都是非变长字段，这样每个记录都是固定长度的，这种存储方式的优点是存储非常迅速，容易缓存，出现故障容易恢复；缺点是占用的空间通常比动态表多。静态表在数据存储时会根据列定义的宽度定义补足空格，但是在访问的时候并不会得到这些空格，这些空格在返回给应用之前已经去掉。同时需要注意：在某些情况下可能需要返回字段后的空格，而使用这种格式时后面到空格会被自动处理掉。

动态表包含变长字段，记录不是固定长度的，这样存储的优点是占用空间较少，但是频繁到更新删除记录会产生碎片，需要定期执行 OPTIMIZE TABLE 语句或 myisamchk -r 命令来改善性能，并且出现故障的时候恢复相对比较困难。

压缩表由 myisamchk 工具创建，占据非常小的空间，因为每条记录都是被单独压缩的，所以只有非常小的访问开支。

MyISAM 支持以下三种类型的索引：

1. B-Tree 索引

   B-Tree 索引，顾名思义，就是所有的索引节点都按照 balancetree 的数据结构来存储，所有的索引数据节点都在叶节点。

2. R-Tree 索引

   R-Tree 索引的存储方式和 b-tree 索引有一些区别，主要设计用于为存储空间和多维数据的字段做索引，所以目前的 MySQL 版本来说，也仅支持 geometry 类型的字段作索引。

3. Full-text 索引

   Full-text 索引就是我们长说的全文索引，他的存储结构也是 b-tree。主要是为了解决在我们需要用 like 查询的低效问题。
